<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="吉他维修预约 - 填写维修信息">
  <title>吉他维修预约 | 411吉他工作室</title>

  <!-- CSS -->
  <link rel="stylesheet" href="css/layout-new.css">
  <link rel="stylesheet" href="css/responsive-new.css">
  <link rel="stylesheet" href="css/animations-new.css">
  <link rel="stylesheet" href="css/booking.css">
</head>
<body>
  <!-- Header Navigation -->
  <header class="header" role="banner">
    <nav class="header__nav" role="navigation" aria-label="主导航">
      <div class="header__logo">
        <a href="index.html" aria-label="返回首页">411吉他工作室</a>
      </div>
      <ul class="header__menu">
        <li class="header__menu-item"><a href="index.html">首页</a></li>
        <li class="header__menu-item"><a href="booking.html">维修预约</a></li>
        <li class="header__menu-item"><a href="about.html">关于我们</a></li>
      </ul>
      <button class="header__menu-toggle" aria-label="切换菜单" aria-expanded="false">
        <span class="header__menu-icon"></span>
      </button>
    </nav>
  </header>

  <!-- Main Content -->
  <main class="main" role="main">
    <div class="container">
      <!-- Breadcrumb -->
      <nav class="breadcrumb" aria-label="面包屑导航">
        <ol class="breadcrumb__list">
          <li class="breadcrumb__item"><a href="index.html">首页</a></li>
          <li class="breadcrumb__item" aria-current="page">吉他维修预约</li>
        </ol>
      </nav>

      <!-- Booking Form -->
      <section class="booking" aria-labelledby="booking-title">
        <h1 id="booking-title" class="booking__title">吉他维修预约</h1>
        <p class="booking__description">请填写以下信息，我们将尽快为您安排维修服务</p>

        <!-- Repair Form -->
        <form class="booking__form" id="repair-form" novalidate>
          <div class="form-group">
            <label for="user-phone" class="form-group__label">
              电话 <span class="form-group__required" aria-label="必填">*</span>
            </label>
            <input
              type="tel"
              id="user-phone"
              name="userPhone"
              class="form-group__input"
              required
              aria-required="true"
              aria-describedby="user-phone-error"
            >
            <span id="user-phone-error" class="form-group__error" role="alert"></span>
          </div>

          <div class="form-group">
            <label for="guitar-type" class="form-group__label">
              吉他类型 <span class="form-group__required" aria-label="必填">*</span>
            </label>
            <select
              id="guitar-type"
              name="guitarType"
              class="form-group__input"
              required
              aria-required="true"
              aria-describedby="guitar-type-error"
            >
              <option value="">请选择吉他类型</option>
              <option value="acoustic">木吉他</option>
              <option value="classical">古典吉他</option>
              <option value="electric">电吉他</option>
              <option value="bass">贝斯</option>
              <option value="other">其他</option>
            </select>
            <span id="guitar-type-error" class="form-group__error" role="alert"></span>
          </div>

          <div class="form-group">
            <label for="guitar-brand" class="form-group__label">
              吉他品牌
            </label>
            <input
              type="text"
              id="guitar-brand"
              name="guitarBrand"
              class="form-group__input"
              placeholder="例如：Martin, Fender, Gibson"
              aria-describedby="guitar-brand-hint"
            >
            <span id="guitar-brand-hint" class="form-group__hint">选填</span>
          </div>

          <div class="form-group">
            <label for="guitar-model" class="form-group__label">
              吉他型号
            </label>
            <input
              type="text"
              id="guitar-model"
              name="guitarModel"
              class="form-group__input"
              placeholder="例如：D-28, Stratocaster"
              aria-describedby="guitar-model-hint"
            >
            <span id="guitar-model-hint" class="form-group__hint">选填</span>
          </div>

          <div class="form-group">
            <label for="problem-description" class="form-group__label">
              问题描述与备注 <span class="form-group__required" aria-label="必填">*</span>
            </label>
            <textarea
              id="problem-description"
              name="problemDescription"
              class="form-group__textarea"
              rows="4"
              required
              aria-required="true"
              aria-describedby="problem-description-error"
              placeholder="请详细描述吉他的问题，例如：琴颈弯曲、弦距过高、拾音器杂音等"
            ></textarea>
            <span id="problem-description-error" class="form-group__error" role="alert"></span>
          </div>

          <div class="form-group">
            <label for="guitar-image" class="form-group__label">
              吉他图片/视频
            </label>
            <input
              type="file"
              id="guitar-image"
              name="guitarImage"
              class="form-group__input"
              accept="image/jpeg,image/png,image/webp,image/jpg,video/mp4"
              multiple
              aria-describedby="guitar-image-hint"
            >
            <span id="guitar-image-hint" class="form-group__hint">
              支持 JPG、PNG、WEBP、MP4 格式，最大 10MB，最多5个文件（选填）
            </span>
            <div id="image-reselect-link" style="display: none; margin-top: 0.5rem;">
              <a href="#" id="reselect-files" style="color: var(--color-primary); text-decoration: underline; font-size: 0.875rem;">
                重新选择文件
              </a>
            </div>
            <div id="image-preview-container" class="form-group__preview-container">
              <!-- Previews will be dynamically added here -->
            </div>
          </div>

          <div class="form-group">
            <label for="appointment-date" class="form-group__label">
              预约日期 <span class="form-group__required" aria-label="必填">*</span>
            </label>
            <input
              type="date"
              id="appointment-date"
              name="appointmentDate"
              class="form-group__input"
              required
              aria-required="true"
              aria-describedby="appointment-date-error"
            >
            <span id="appointment-date-error" class="form-group__error" role="alert"></span>
          </div>

          <div class="form-group">
            <label for="appointment-time" class="form-group__label">
              预约时间段 <span class="form-group__required" aria-label="必填">*</span>
            </label>
            <div id="time-slots-container" class="time-slots">
              <p class="time-slots__hint">请先选择日期</p>
            </div>
            <input type="hidden" id="appointment-time" name="appointmentTime" required>
            <span id="appointment-time-error" class="form-group__error" role="alert"></span>
          </div>

          <div class="form-group">
            <label for="expected-completion-date" class="form-group__label">
              期望完成日期 <span class="form-group__required" aria-label="必填">*</span>
            </label>
            <input
              type="date"
              id="expected-completion-date"
              name="expectedCompletionDate"
              class="form-group__input"
              required
              aria-required="true"
              aria-describedby="expected-completion-date-error"
            >
            <span id="expected-completion-date-error" class="form-group__error" role="alert"></span>
          </div>

          <div class="form-group">
            <label class="form-group__checkbox">
              <input
                type="checkbox"
                id="terms-agreement"
                name="termsAgreement"
                required
                aria-required="true"
                aria-describedby="terms-error"
              >
              <span>我已阅读并同意<a href="#" id="view-terms-btn" class="form-group__link">服务条款</a></span>
            </label>
            <span id="terms-error" class="form-group__error" role="alert"></span>
          </div>

          <div class="booking__actions">
            <button type="submit" class="button button--primary button--large">
              提交维修单
            </button>
            <a href="index.html" class="button button--secondary button--large">
              取消
            </a>
          </div>

          <!-- Form Status Messages -->
          <div class="booking__status" id="form-status" role="status" aria-live="polite"></div>
        </form>
      </section>
    </div>
  </main>

  <!-- Service Terms Modal -->
  <div id="terms-modal" class="modal" style="display: none;">
    <div class="modal__overlay"></div>
    <div class="modal__content">
      <div class="modal__header">
        <h2 class="modal__title">411吉他维修工作室服务条款</h2>
        <button class="modal__close" aria-label="关闭">&times;</button>
      </div>
      <div class="modal__body" style="max-height: 70vh; overflow-y: auto;">
        <h3 style="color: var(--color-accent-primary); margin-bottom: 1rem;">服务时效</h3>
        <p style="margin-bottom: 1.5rem; line-height: 1.8; color: #1a1a1a;">
          维修周期将根据具体维修项目，在接收乐器时与客户协商确定。我方将尽力在约定时间内完成维修，但具体交付时间可能因实际工作量、配件供应等因素有所调整。
        </p>

        <h3 style="color: var(--color-accent-primary); margin-bottom: 1rem;">付款方式</h3>
        <p style="margin-bottom: 0.5rem; line-height: 1.8; color: #1a1a1a;">
          客户需预付维修总费用20% 作为定金，以确认并排期维修服务。
        </p>
        <p style="margin-bottom: 0.5rem; line-height: 1.8; color: #1a1a1a;">
          余款需在维修完成、客户验收无误后，取件时一次性付清。
        </p>
        <p style="margin-bottom: 1.5rem; line-height: 1.8; color: #1a1a1a;">
          在余款结清前，我方有权留置已维修完成的乐器。
        </p>

        <h3 style="color: var(--color-accent-primary); margin-bottom: 1rem;">不可抗力与交付延迟</h3>
        <p style="margin-bottom: 1.5rem; line-height: 1.8; color: #1a1a1a;">
          如因自然灾害、政府行为、战争、罢工、疫情、供应链中断、配件短缺等不可抗力因素，或非因我方故意或重大过失导致的意外情况，造成维修交付延迟，我方不构成违约，并有权相应顺延交付时间。
        </p>

        <h3 style="color: var(--color-accent-primary); margin-bottom: 1rem;">客户责任</h3>
        <p style="margin-bottom: 0.5rem; line-height: 1.8; color: #1a1a1a;">
          客户应在交付维修前，如实告知乐器的已知状况、损坏历史及特殊要求。
        </p>
        <p style="margin-bottom: 1.5rem; line-height: 1.8; color: #1a1a1a;">
          对于因客户隐瞒或未告知的既有问题导致的额外维修或风险，我方不承担责任。
        </p>

        <h3 style="color: var(--color-accent-primary); margin-bottom: 1rem;">免责声明</h3>
        <p style="margin-bottom: 0.5rem; line-height: 1.8; color: #1a1a1a;">
          维修服务旨在恢复乐器的基本演奏功能与状态。对于因乐器本身老化、材料固有缺陷或无法预见的结构性风险，我方在尽到合理注意义务后，不承担无限责任。
        </p>
        <p style="margin-bottom: 1.5rem; line-height: 1.8; color: #1a1a1a;">
          对于极其珍贵或具有特殊意义的乐器，建议客户事先自行购买相应保险。
        </p>

        <h3 style="color: var(--color-accent-primary); margin-bottom: 1rem;">争议解决</h3>
        <p style="margin-bottom: 1rem; line-height: 1.8; color: #1a1a1a;">
          本条款受中华人民共和国法律管辖。如双方就服务发生争议，应首先友好协商解决；协商不成的，任何一方可向我方工作室所在地人民法院提起诉讼。
        </p>
      </div>
    </div>
  </div>

  <!-- Footer -->
  <footer class="footer" role="contentinfo">
    <div class="container">
      <div class="footer__content">
        <div class="footer__section">
          <h3 class="footer__title">联系我们</h3>
          <p class="footer__text">邮箱: repair@guitarservice.com</p>
          <p class="footer__text">电话: 123-456-7890</p>
          <p class="footer__text">营业时间: 周一至周五 9:00-18:00</p>
        </div>
        <div class="footer__section">
          <h3 class="footer__title">快速链接</h3>
          <ul class="footer__links">
            <li><a href="index.html">首页</a></li>
            <li><a href="booking.html">维修预约</a></li>
            <li><a href="about.html">关于我们</a></li>
          </ul>
        </div>
      </div>
      <div class="footer__copyright">
        <p>&copy; 2026 吉他维修服务平台. All rights reserved.</p>
      </div>
    </div>
  </footer>

  <!-- JavaScript -->
  <script type="module" src="js/supabase-client.js"></script>
  <script type="module" src="js/form-handler.js"></script>
  <script type="module" src="js/calendar.js"></script>
</body>
</html>
